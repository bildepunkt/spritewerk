{"version":3,"sources":["webpack:///webpack/bootstrap 414a96714ce35fa6c632","webpack:///./playground/main.js","webpack:///./src/Camera.js","webpack:///./src/Group.js","webpack:///./src/Collection.js","webpack:///./src/Sprite.js","webpack:///./src/util/contextConstants.js","webpack:///./src/Scene.js","webpack:///./src/util/math.js","webpack:///./src/lib/Transform.js","webpack:///./src/Viewport.js","webpack:///./src/util/domHelpers.js","webpack:///./src/util/index.js","webpack:///./src/util/radio.js"],"names":["Pragma","rowLength","width","height","legend","defaults","dev","TileMap","x","y","maps","pragma","currentMap","options","map","length","context","i","len","key","tile","opacity","globalAlpha","undefined","console","warn","fillStyle","fillRect","viewport","camera","scene","canvas","group","default","collection","add","sprite","zoom","startRender","call","Camera","rotation","Group","isGroup","Collection","items","item","name","push","index","getCount","splice","fn","scope","bind","doContinue","filteredItems","each","predicate","value","Sprite","sx","sy","composite","SOURCE_OVER","visible","uuid","uuidCount","parentTransforms","globalCompositeOperation","contextConstants","SOURCE_IN","SOURCE_OUT","SOURCE_ATOP","DESTINATION_OVER","DESTINATION_IN","DESTINATION_OUT","DESTINATION_ATOP","LIGHTER","COPY","XOR","MULTIPLY","SCREEN","OVERLAY","DARKEN","LIGHTEN","COLOR_DODGE","COLOR_BURN","HARD_LIGHT","SOFT_LIGHT","DIFFERENCE","EXCLUSION","HUE","SATURATION","COLOR","LUMINOSITY","debug","Scene","ctx","getContext","transform","xformOffset","cameraXformOffset","cam","translate","rotationOffsetWidth","rotationOffsetHeight","rotate","scaleOffsetWidth","scaleOffsetHeight","scale","transformPoint","setTransform","apply","Array","prototype","slice","matrix","save","_applyCameraTransforms","render","renderItem","restore","_applyTransforms","factor","updateItem","update","degreesToRadians","radiansToDegrees","deg","Math","PI","rad","Transform","stack","reset","m","clone","pop","m11","m12","m21","m22","dx","dy","d","m0","m1","m2","m3","m4","m5","c","cos","s","sin","px","py","fitToWindow","window","document","parent","Viewport","body","createElement","video","viewportStyles","left","position","top","appendChild","_onResize","posCoords","innerWidth","innerHeight","applyStyles","el","styles","val","style","elWidth","elHeight","winWidth","winHeight","LANDSCAPE_RATIO","PORTRAIT_RATIO","IS_LANDSCAPE","winLandscapeRatio","winPortraitRatio","offsetLeft","offsetTop","offsetWidth","offsetHeight","isNumeric","n","isNaN","parseFloat","isFinite","handlers","_addScopedHandler","event","handler","scopedHandler","original","scoped","_removeScopedHandler","tuneIn","target","addEventListener","tuneOut","removeEventListener","broadcast","data","evt","MouseEvent","CustomEvent","detail","dispatchEvent"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 414a96714ce35fa6c632\n **/","import Camera from \"../src/Camera\";\nimport Group from \"../src/Group\";\nimport Scene from \"../src/Scene\";\nimport Sprite from \"../src/Sprite\";\nimport Viewport from \"../src/Viewport\";\n\n/**\n * @class Pragma\n * @property {Integer} rowLength - The length of the \"rows\" in the array. Needed because not using matrices for perf reasons.\n * @property {Integer} width - The tile width\n * @property {Integer} height - The tile height\n * @property {Array} legend - The various asset paths or colors to render.The index corresponds to the tilemap's values.\n *                          `null` values will result in an empty/transparent tile.\n */\nclass Pragma {\n    constructor (rowLength, width, height, legend) {\n        this.rowLength = rowLength;\n        this.width = width;\n        this.height = height;\n        this.legend = legend;\n    }\n}\n\n/**\n * Maps and renders bitmap and/or color tiles from an array\n * @class TileMap\n */\nlet defaults = {\n    dev: true\n};\n\nclass TileMap extends Sprite {\n    /**\n     * @param {Number} x - The x position\n     * @param {Number} y - The y position\n     * @param {Object} maps - An object of arrays with indices mapped to values\n     * @param {String} currentMap - The name of the current map\n     * @param {Pragma} pragma - The pragma for parsing the map\n     * @param {Object} options - General options\n     */\n    constructor (x, y, maps, pragma, currentMap=\"default\", options=defaults) {\n        super(x, y);\n\n        this.maps = maps;\n        this.pragma = pragma;\n        this.currentMap = currentMap;\n        this.options = options;\n        \n        let map = this.maps[this.currentMap];\n\n        this.width = this.pragma.rowLength * this.pragma.width;\n        this.height = (map.length / this.pragma.rowLength) * this.pragma.height;\n    }\n\n    render (context) {\n        super.render(context);\n        \n        let map = this.maps[this.currentMap];\n        let x = 0;\n        let y = 0;\n\n        for (let i = 0, len = map.length; i < len; i++) {\n            let key = map[i];\n            let tile = this.pragma.legend[key];\n            let opacity = context.globalAlpha;\n\n            if (x === this.pragma.rowLength) {\n                x = 0;\n                y += 1;\n            }\n            \n            if (tile === undefined) {\n                if (key === null) { // index purposefully blank\n                    context.globalAlpha = 0;\n                } else {\n                    if (this.options.dev) {\n                        console.warn(`Pragma.legend index \\`${key}\\` does not exist`);\n                    }\n                }\n            } else {\n                context.fillStyle = tile;\n                context.fillRect(\n                    x * this.pragma.width, y * this.pragma.height,\n                    this.pragma.width, this.pragma.height\n                );\n            }\n\n            x += 1;\n            context.globalAlpha = opacity;\n        }\n    }\n}\n\n(() => {\n    let viewport = new Viewport(512, 512);\n    let camera = new Camera(0, 0, 512, 512);\n    let scene = new Scene(viewport.canvas, camera);\n    let group = new Group();\n    let tile = new TileMap(256, 256, {\n        default: [\n            0, 1, 0, 1,\n            1, 0, 1, 0,\n            0, 1, 0, 1,\n            1, 0, 1, null\n        ]\n    }, new Pragma(4, 32, 32, [\n        \"#DDD\",\n        \"#EEE\"\n    ]));\n\n    group.collection.add(tile);\n    group.collection.add(new Group());\n    group.sprite.opacity = 0.6;\n    \n    //camera.x = 64;\n    //camera.rotation = 45;\n    camera.zoom = 2;\n    \n    scene.startRender(group);\n}).call(this);\n\n\n\n/** WEBPACK FOOTER **\n ** ./playground/main.js\n **/","/**\n * @class Camera\n * @param {Integer} [x=0] - The x coordinate\n * @param {Integer} [y=0] - The y coordinate\n * @param {Integer} [width=800] - The viewport width\n * @param {Integer} [height=600] - The viewport height\n */\nexport default class Camera {\n    constructor (x=0, y=0, width=800, height=600) {\n        /**\n         * @member {Integer} Camera#x - The camera's x position\n         */\n        this.x = x;\n        /**\n         * @member {Integer} Camera#y - The camera's y position\n         */\n        this.y = y;\n        /**\n         * @member {Integer} Camera#width - The viewport width\n         */\n        this.width = width;\n        /**\n         * @member {Integer} Camera#height - The viewport height\n         */\n        this.height = height;\n        /**\n         * @member {Float} Camera#rotation - The camera's rotation\n         */\n        this.rotation = 0;\n        /**\n         * @member {Float} Camera#zoom - The camera's zoom value\n         */\n        this.zoom = 1;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Camera.js\n **/","import Collection from \"./Collection\";\nimport Sprite from \"./Sprite\";\n\n/**\n * Composes Sprite and Collection\n * @class Group\n * @requires Collection\n * @requires Sprite\n */\nexport default class Group {\n    constructor () {\n        /**\n         * @member {Collection} Group#collection - The group's collection\n         */\n        this.collection = new Collection();\n        /**\n         * @member {Sprite} Group#sprite - The group's display object\n         */\n        this.sprite = new Sprite();\n        /**\n         * @member {Boolean} Group#isGroup - Denote's the object as a group\n         */\n        this.isGroup = true;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Group.js\n **/","/**\n * @class Collection\n */\nexport default class Collection {\n    constructor () {\n        /**\n         * @member {Array} Collection#items - the collection of items\n         */\n        this.items = [];\n    }\n\n    /**\n     * Add an item with optional name\n     * @method Collection#add\n     * @param  {Any}    item - The item to add\n     * @param  {String} [name=\"\"] - The optional name of the item\n     */\n    add (item, name=\"\") {\n        this.items.push({\n            item, name\n        });\n    }\n\n    /**\n     * Add an item at a given index\n     * @method Collection#addAt\n     * @param  {Integer} index - The index to add the item\n     * @param  {Any}     item - The item to add\n     * @param  {String}  [name=\"\"] - The optional name of the item\n     */\n    addAt (index, item, name=\"\") {\n        if (index > this.getCount()) {\n            this.add(item, name);\n        } else {\n            this.items.splice(index, 0, {\n                item, name\n            });\n        }\n    }\n\n    /**\n     * Add multiple items\n     * @method Collection#addMany\n     * @param  {...Object} items - An object containing item and optional name. eg: <code>{item: someItem, name: \"someName\"}</code>\n     */\n    addMany (...items) {\n        for (let item of items) {\n            this.add(item.item, item.name);\n        }\n    }\n\n    /**\n     * Iterates the collection's sorted items. The item, index, and name are supplied\n     * to the provided function\n     * @method Collection#each\n     * @param {Function} fn - The function to execute on the iterable\n     * @param {Object} [scope] - The scope with which to execute the function\n     */\n    each (fn, scope) {\n        fn = scope ? fn.bind(scope) : fn;\n\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            let doContinue;\n\n            // if item on last item and an item is removed\n            if (!item) {\n                break;\n            }\n\n            doContinue = fn(item.item, item.name, i);\n\n            if (doContinue === false) {\n                break;\n            }\n        }\n    }\n\n    /**\n     * Returns an object by name\n     * @method Collection#fetch\n     * @param  {String} name - The name of the object to fetch\n     * @return {Any}\n     */\n    fetch (name) {\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            if (item.name === name) {\n                return item.item;\n            }\n        }\n    }\n\n    /**\n     * Returns an object at a given index\n     * @method Collection#fetchAt\n     * @param  {Integer} index - The index\n     * @return {Any}\n     */\n    fetchAt (index) {\n        return this.items[index].item;\n    }\n\n    /**\n     * Returns the count of items in group\n     * @method Collection#getCount\n     * @return {Integer}\n     */\n    getCount () {\n        return this.items.length;\n    }\n\n    /**\n     * Remove item by name\n     * @method Collection#removeBy\n     * @param {String} name - The name of the object to remove\n     */\n    remove (name) {\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            if (item.name === name) {\n                this.items.splice(i, 1);\n                break;\n            }\n        }\n    }\n\n    /**\n     * Removes all items\n     * @method Collection#removeAll\n     */\n    removeAll () {\n        this.items = [];\n    }\n\n    /**\n     * Remove item at given index\n     * @method Collection#removeAt\n     * @param {Integer} index - The index of the item to remove\n     */\n    removeAt (index) {\n        this.items.splice(index, 1);\n    }\n\n    /**\n     * iterates items and return the ones that meet criteria\n     * @method Collection#filter\n     * @param  {Function} fn - Truth predicate\n     * @param  {Object} [scope] - The scope in which to execute the function\n     * @return {Array}\n     */\n    filter(fn, scope) {\n        let filteredItems = [];\n\n        this.each((item, i, name)=> {\n            let predicate = fn(item, i, name);\n\n            if (predicate) {\n                filteredItems.push(item);\n            }\n        }, scope);\n\n        return filteredItems;\n    }\n\n    /**\n     * Assigns a new value to an existing item\n     * @method Collection#update\n     * @param {String} name - The name of the object to modify\n     * @param {Any} value - The new value\n     */\n    update (name, value) {\n        for (let item of this.items) {\n            if (name === item.name) {\n                item = value;\n                break;\n            }\n        }\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/Collection.js\n **/","import contextConstants from \"./util/contextConstants\";\n\n/**\n * @class Sprite\n * @requires contextConstants\n * \n * @param {Integer} [x=0] - The x coordinate\n * @param {Integer} [y=0] - The y coordinate\n * @param {Integer} [width=64] - The width\n * @param {Integer} [height=64] - The height\n */\nclass Sprite {\n    constructor (x=0, y=0, width=64, height=64) {\n        /**\n         * @member {Integer} Sprite#x - The sprite's x coordinate\n         */\n        this.x = x;\n        /**\n         * @member {Integer} Sprite#y - The sprite's y coordinate\n         */\n        this.y = y;\n        /**\n         * @member {Integer} Sprite#width - The sprite's width\n         */\n        this.width = width;\n        /**\n         * @member {Integer} Sprite#height - The sprite's height\n         */\n        this.height = height;\n        /**\n         * @member {Float} Sprite#sx - The sprite's horizontal scale\n         */\n        this.sx = 1;\n        /**\n         * @member {Float} Sprite#sy - The sprite's horizontal scale\n         */\n        this.sy = 1;\n        /**\n         * @member {Float} Sprite#rotation - The sprite's rotation\n         */\n        this.rotation = 0;\n        /**\n         * @member {Float} Sprite#composite - The sprite's composite setting\n         */\n        this.composite = contextConstants.SOURCE_OVER;\n        /**\n         * @member {Float} Sprite#opacity - The sprite's opacity\n         */\n        this.opacity = 1;\n        /**\n         * @member {Boolean} Sprite#visible - If false sprite is not rendered\n         */\n        this.visible = true;\n        /**\n         * @member {Float} Sprite#uuid - The sprite's unique ID\n         */\n        this.uuid = Sprite.uuidCount++;\n        /**\n         * @member {Float} Sprite#parentTransforms - A parent group's coordinates\n         */\n        this.parentTransforms = {\n            x: 0, y: 0\n        };\n    }\n    \n    /**\n     * @method Sprite#render\n     * @param  {CanvasRenderingContext2D} context - The rendering context\n     * @return {undefined}\n     */\n    render (context) {\n        context.globalAlpha *= this.opacity;\n\n        if (this.composite !== Sprite.SOURCE_OVER) {\n            context.globalCompositeOperation = this.composite;\n        }\n    }\n\n    /**\n     * A noop\n     * @method Sprite#update\n     * @return {undefined}\n     */\n    update () {}\n    \n    /**\n     * @member {Integer} Sprite#gx - The global x coordinate (the local + parent transforms)\n     */\n    get gx () {\n        return this.x + this.parentTransforms.x;\n    }\n    \n    /**\n     * @member {Integer} Sprite#gy - The global y coordinate (the local + parent transforms)\n     */\n    get gy () {\n        return this.y + this.parentTransforms.y;\n    }\n}\n\nSprite.uuidCount = 0;\n\nexport default Sprite;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Sprite.js\n **/","const contextConstants = {\n    SOURCE_OVER: \"source-over\",\n    SOURCE_IN: \"source-in\",\n    SOURCE_OUT: \"source-out\",\n    SOURCE_ATOP: \"source-atop\",\n    DESTINATION_OVER: \"destination-over\",\n    DESTINATION_IN: \"destination-in\",\n    DESTINATION_OUT: \"destination-out\",\n    DESTINATION_ATOP: \"destination-atop\",\n    LIGHTER: \"lighter\",\n    COPY: \"copy\",\n    XOR: \"xor\",\n    MULTIPLY: \"multiply\",\n    SCREEN: \"screen\",\n    OVERLAY: \"overlay\",\n    DARKEN: \"darken\",\n    LIGHTEN: \"lighten\",\n    COLOR_DODGE: \"color-dodge\",\n    COLOR_BURN: \"color-burn\",\n    HARD_LIGHT: \"hard-light\",\n    SOFT_LIGHT: \"soft-light\",\n    DIFFERENCE: \"difference\",\n    EXCLUSION: \"exclusion\",\n    HUE: \"hue\",\n    SATURATION: \"saturation\",\n    COLOR: \"color\",\n    LUMINOSITY: \"luminosity\"\n};\n\nexport default contextConstants;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/contextConstants.js\n **/","import { degreesToRadians } from \"./util/math\";\nimport Transform from \"./lib/Transform\";\n\nlet defaults = {\n    debug: true\n};\n\n/**\n * Handles rendering entities onto the canvas element\n * @class Scene\n * @requires Transform\n * \n * @param {HTMLElement} canvas - The active canvas element\n * @param {Camera} camera - The camera instance\n * @param {Object} [options]\n * @param {Boolean} [options.debug=true] - If true, renders debug objects\n */\nexport default class Scene {\n    constructor (canvas, camera, options=defaults) {\n        /**\n         * @member {HTMLElement} Scene#canvas - The active canvas element\n         */\n        this.canvas = canvas;\n        /**\n         * @member {Camera} Scene#camera - The camera instance\n         */\n        this.camera = camera;\n        /**\n         * @member {HTMLElement} Scene#options - The Scene's options\n         */\n        this.options = options;\n        /**\n         * @member {CanvasRenderingContext2D} Scene#ctx - The canvas rendering object\n         */\n        this.ctx = canvas.getContext(\"2d\");\n        /**\n         * @member {Transform} Scene#transform - The transformation matrix tracker\n         */        \n        this.transform = new Transform();\n\n        this.xformOffset = null;\n        this.cameraXformOffset = null;\n    }\n    \n    /**\n     * Applies the camera's transforms to the Transform > context\n     * @method Scene#_applyCameraTransforms\n     * @param {Camera} cam - The camera instance\n     */\n    _applyCameraTransforms (cam) {\n        this.transform.translate(-cam.x, -cam.y);\n        \n        if (cam.rotation !== 0) {\n            let rotationOffsetWidth = cam.width / 2;\n            let rotationOffsetHeight = cam.height / 2;\n            this.transform.translate(rotationOffsetWidth, rotationOffsetHeight);\n            this.transform.rotate(degreesToRadians(cam.rotation));\n            this.transform.translate(-rotationOffsetWidth, -rotationOffsetHeight);\n        }\n        \n        if (cam.zoom !== 1) {\n            let scaleOffsetWidth = (cam.width / 2) * (cam.zoom - 1);\n            let scaleOffsetHeight = (cam.height / 2) * (cam.zoom - 1);\n            this.transform.translate(-scaleOffsetWidth, -scaleOffsetHeight);\n            this.transform.scale(cam.zoom, cam.zoom);\n        }\n\n        this.cameraXformOffset = this.transform.transformPoint();\n        \n        this.ctx.setTransform.apply(\n            this.ctx, Array.prototype.slice.call(this.transform.matrix)\n        );\n    }\n\n    /**\n     * Applies a Sprite's transforms to the Transform > context\n     * @method Scene#_applyTransforms\n     * @param {Sprite} item - The sprite\n     */\n    _applyTransforms (item) {\n        this.transform.translate(item.x, item.y);\n        this.transform.rotate(degreesToRadians(item.rotation));\n        this.transform.scale(item.sx, item.sy);\n\n        this.xformOffset = this.transform.transformPoint();\n\n        this.ctx.setTransform.apply(\n            this.ctx, Array.prototype.slice.call(this.transform.matrix)\n        );\n    }\n\n    /**\n     * [startRender description]\n     * @method Scene#startRender\n     * @param {Group} group The group to render\n     */\n    startRender (group) {\n        this.ctx.save();\n        this.transform.save();\n        \n        this._applyCameraTransforms(this.camera);\n        group.sprite.render(this.ctx);\n\n        group.collection.each((item)=> {\n            this.renderItem(item);\n        });\n\n        this.ctx.restore();\n        this.transform.restore();\n    }\n\n    /**\n     * [renderItem description]\n     * @method Scene#renderItem\n     * @param  {Sprite|Group} item The item to render\n     */\n    renderItem (item) {\n        if (item.isGroup) {\n            this.ctx.save();\n            this.transform.save();\n\n            this._applyTransforms(item.sprite);\n\n            if (this.options.debug) {\n                this.ctx.fillRect(-8, -1, 16, 2);\n                this.ctx.fillRect(-1, -8, 2, 16);\n            }\n\n            item.sprite.render(this.ctx);\n            \n            item.collection.each((item)=> {\n                this.renderItem(item);\n            });\n\n            this.ctx.restore();\n            this.transform.restore();\n        } else {\n            item.parentTransforms = this.transform.transformPoint();\n            // assign parent transforms before applying sprite's transforms\n            this._applyTransforms(item);\n            item.render(this.ctx);\n        }\n    }\n\n    /**\n     * [startUpdate description]\n     * @method Scene#startUpdate\n     * @param  {Group} group [description]\n     * @param  {Float} factor [description]\n     */\n    startUpdate (group, factor) {\n        group.collection.each((item)=> {\n            this.updateItem(item, factor);\n        });\n    }\n\n    /**\n     * [updateItem description]\n     * @method Scene#updateItem\n     * @param  {Sprite|Group} item [description]\n     * @param  {Float} factor [description]\n     */\n    updateItem (item, factor) {\n        if (item.isGroup) {\n            item.collection.each((item)=> {\n                this.updateItem(item, factor);\n            });\n        } else {\n            item.update(factor);\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Scene.js\n **/","/**\n * @namespace util/math\n */\n\n/**\n * Convert degrees to radians\n * @memberOf util/math\n * @method degreesToRadians\n * @param  {Integer} deg The degrees to convert\n * @return {Float}\n */\nexport function degreesToRadians (deg) {\n    return deg * Math.PI / 180;\n}\n\n/**\n * Convert radians to degrees\n * @memberOf util/math\n * @method radiansToDegrees\n * @param  {Float} rad The radians to convert\n * @return {Integer}\n */\nexport function radiansToDegrees (rad) {\n    return rad * 180 / Math.PI;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/math.js\n **/","/*\n * A fork from Simon Sarris\n */\nexport default class Transform {\n    constructor () {\n        this.stack = [];\n        this.reset();\n    }\n    \n    clone () {\n        let m = this.m;\n        return [m[0], m[1], m[2], m[3], m[4], m[5]];\n    }\n\n    reset () {\n        this.m = [1, 0, 0, 1, 0, 0];\n    }\n    \n    save () {\n        this.stack.push(this.clone());\n    }\n    \n    restore () {\n        if (this.stack.length) {\n            let matrix = this.stack.pop();\n            this.m = matrix;\n        }\n    }\n\n    multiply (matrix) {\n        var m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n        var m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n\n        var m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n        var m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n\n        var dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n        var dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        this.m[4] = dx;\n        this.m[5] = dy;\n    }\n\n    invert () {\n        var d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n        var m0 = this.m[3] * d;\n        var m1 = -this.m[1] * d;\n        var m2 = -this.m[2] * d;\n        var m3 = this.m[0] * d;\n        var m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n        var m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n        this.m[0] = m0;\n        this.m[1] = m1;\n        this.m[2] = m2;\n        this.m[3] = m3;\n        this.m[4] = m4;\n        this.m[5] = m5;\n    }\n\n    rotate (rad) {\n        var c = Math.cos(rad);\n        var s = Math.sin(rad);\n        var m11 = this.m[0] * c + this.m[2] * s;\n        var m12 = this.m[1] * c + this.m[3] * s;\n        var m21 = this.m[0] * -s + this.m[2] * c;\n        var m22 = this.m[1] * -s + this.m[3] * c;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n    }\n\n    translate (x, y) {\n        this.m[4] += this.m[0] * x + this.m[2] * y;\n        this.m[5] += this.m[1] * x + this.m[3] * y;\n    }\n\n    scale (sx, sy) {\n        this.m[0] *= sx;\n        this.m[1] *= sx;\n        this.m[2] *= sy;\n        this.m[3] *= sy;\n    }\n\n    transformPoint (px=0, py=0) {\n        var x = px;\n        var y = py;\n        px = x * this.m[0] + y * this.m[2] + this.m[4];\n        py = x * this.m[1] + y * this.m[3] + this.m[5];\n        \n        return {\n            x: px,\n            y: py\n        };\n    }\n\n    get matrix () {\n        return this.m;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/Transform.js\n **/","import { applyStyles, fitToWindow } from \"./util/domHelpers\";\nimport { tuneIn } from \"./util/radio\";\n\nconst defaults = {\n    fitToWindow: true,\n    window: null,\n    document: null,\n    parent: null\n};\n\n/**\n * @class Viewport\n * @requires util/domHelpers\n * @requires util/radio\n *\n * @param {Integer} width The game width\n * @param {Integer} height The game height\n * @param {Object} options\n * @param {HTMLElement} [options.parent=document.body] - The parent element\n * @param {Boolean} [options.fitToWindow=true] - If true, the viewport will fill the screen while maintaining aspect ratio\n */\nexport default class Viewport {\n    constructor (width, height, options=defaults) {\n        if (options.window === null) {\n            options.window = window;\n        }\n        if (options.document === null) {\n            options.document = document;\n        }\n        if (options.parent === null) {\n            options.parent = options.document.body;\n        }\n\n        /**\n         * @member {Integer} Viewport#width - The viewport's width\n         */\n        this.width = width;\n        /**\n         * @member {Integer} Viewport#height - The viewport's height\n         */\n        this.height = height;\n        /**\n         * @member {Integer} Viewport#options - The viewport's options\n         */\n        this.options = options;\n        /**\n         * @member {HTMLElement} Viewport#canvas - The canvas element\n         */\n        this.canvas = options.document.createElement(\"canvas\");\n        /**\n         * @member {HTMLElement} Viewport#video - The video element\n         */        \n        this.video = options.document.createElement(\"video\");\n\n        this.canvas.width = width;\n        this.canvas.height = height;\n\n        const viewportStyles = {\n            height: this.height,\n            left: 0,\n            position: \"absolute\",\n            top: 0,\n            width: this.width\n        };\n    \n        applyStyles(this.canvas, viewportStyles);\n        applyStyles(this.video, viewportStyles);\n\n        options.parent.appendChild(this.canvas);\n        options.parent.appendChild(this.video);\n\n        if (options.fitToWindow) {\n            tuneIn(options.window, \"resize\", this._onResize, this);\n            tuneIn(options.window, \"orientationchange\", this._onResize, this);\n            this._onResize();\n        }\n    }\n\n    /**\n     * @method Viewport#_onResize\n     */\n    _onResize () {\n        const posCoords = fitToWindow(this.width, this.height, this.options.window.innerWidth, this.options.window.innerHeight);\n\n        applyStyles(this.canvas, posCoords);\n        applyStyles(this.video, posCoords);\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Viewport.js\n **/","import { isNumeric } from \"./\";\n\n/**\n * @namespace util/domHelpers\n */\n\n/**\n * loops through style object and applies values. Adds \"px\" to numeric values.\n * @memberOf util/domHelpers\n * @method applyStyles\n * @param {HTMLElement} el     The element to apply styles to\n * @param {Object}      styles The key/value pair styles\n */\nexport function applyStyles (el, styles) {\n    for (let key in styles) {\n        let val = styles[key];\n        \n        el.style[key] = isNumeric(val) ? `${val}px` : val;\n    }\n}\n\n/**\n * Returns position & dimensions for a DOM element to fit in the viewport while maintaining aspect ratio\n * @memberOf util/domHelpers\n * @method fitToWindow\n * @param  {Integer} elWidth   The element's original width\n * @param  {Integer} elHeight  The element's original height\n * @param  {Integer} winWidth  The window's current width\n * @param  {Integer} winHeight The window's current height\n * @return {Object}            The calculated left, top, width, height\n */\nexport function fitToWindow (elWidth, elHeight, winWidth, winHeight) {\n    const LANDSCAPE_RATIO = elHeight / elWidth;\n    const PORTRAIT_RATIO  = elWidth / elHeight;\n    const IS_LANDSCAPE    = LANDSCAPE_RATIO < PORTRAIT_RATIO ? true : false;\n    let winLandscapeRatio = winHeight / winWidth;\n    let winPortraitRatio  = winWidth / winHeight;\n    let offsetLeft = 0;\n    let offsetTop  = 0;\n    let offsetWidth;\n    let offsetHeight;\n\n    if (IS_LANDSCAPE) {\n        if (LANDSCAPE_RATIO < winLandscapeRatio) {\n            offsetWidth = winWidth;\n            offsetHeight = offsetWidth * LANDSCAPE_RATIO;\n            offsetTop = (winHeight - offsetHeight) / 2;\n        } else {\n            offsetHeight = winHeight;\n            offsetWidth = winHeight * PORTRAIT_RATIO;\n            offsetLeft = (winWidth - offsetWidth) / 2;\n        }\n    } else {\n        if (PORTRAIT_RATIO < winPortraitRatio) {\n            offsetHeight = winHeight;\n            offsetWidth = winHeight * PORTRAIT_RATIO;\n            offsetLeft = (winWidth - offsetWidth) / 2;\n        } else {\n            offsetWidth = winWidth;\n            offsetHeight = offsetWidth * LANDSCAPE_RATIO;\n            offsetTop = (winHeight - offsetHeight) / 2;\n        }\n    }\n\n    return {\n        width: offsetWidth,\n        height: offsetHeight,\n        left: offsetLeft,\n        top: offsetTop\n    };\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/domHelpers.js\n **/","/**\n * @namespace util\n */\n\n/**\n * Determine if an input is numeric or not\n * @method isNumeric\n * @memberOf util\n * @param {Any} n - A value to evaluate\n * @return {Boolean}\n */\nconst isNumeric = (n) => !isNaN(parseFloat(n)) && isFinite(n);\n\nexport {\n    isNumeric\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/index.js\n **/","let handlers = {};\n\n/**\n * @namespace util/radio\n */\n\n/**\n * @method _addScopedHandler\n * @memberOf util/radio\n * @param  {String}   event    [description]\n * @param  {Function} handler [description]\n * @param  {Object}   scope    [description]\n * @return {Function} The scoped handler\n */\nfunction _addScopedHandler (event, handler, scope) {\n    if (handlers[event] === undefined) {\n        handlers[event] = [];\n    }\n\n    let scopedHandler = scope ? handler.bind(scope) : handler;\n\n    handlers[event].push({\n        original: handler,\n        scoped: scopedHandler\n    });\n\n    return scopedHandler;\n}\n\n/**\n * @method _removeScopedHandler\n * @memberOf util/radio\n * @param  {String}   event   [description]\n * @param  {Function} handler [description]\n * @return {Function}         Returns the scoped handler or original if scope was not passed on `add`\n */\nfunction _removeScopedHandler (event, handler) {\n    let scopedHandler;\n\n    for (let i = 0, len = handlers[event].length; i < len; i++) {\n        if (handler === handler.original) {\n            scopedHandler = handler.scoped;\n            handlers[event].splice(i, 1);\n        }\n    }\n\n    return scopedHandler || handler;\n}\n\n/**\n * @method tuneIn\n * @memberOf util/radio\n * @param {HTMLEntity} target\n * @param {String}     event\n * @param {Function}   handler\n * @param {Object}     [scope]\n */\nfunction tuneIn(target, event, handler, scope) {\n    // we add the handler here (even if no scope is passed) so that we don't have to make the user pass scope\n    // on `remove`\n    handler = _addScopedHandler(event, handler, scope);\n\n    target.addEventListener(event, handler, false);\n}\n\n/**\n * @method tuneOut\n * @memberOf util/radio\n * @param {HTMLEntity} target\n * @param {String}     event\n * @param {Function}   handler\n */\nfunction tuneOut(target, event, handler) {\n    // check that a scoped handler was bound, returns original if not\n    let scopedHandler = _removeScopedHandler(event, handler);\n\n    target.removeEventListener(event, scopedHandler, false);\n}\n\n/**\n * @method broadcast\n * @memberOf util/radio\n * @param {Any}    target\n * @param {String} event\n * @param {Object} data\n */\nfunction broadcast(target, event, data) {\n    let evt;\n\n    switch(event) {\n    // TODO verify MouseEvent\n    case \"click\":\n    case \"dblclick\":\n    case \"mousedown\":\n    case \"mouseup\":\n    case \"mousemove\":\n        evt = new MouseEvent(event, {\n            \"view\": window,\n            \"bubbles\": true,\n            \"cancelable\": false\n        });\n        break;\n    default:\n        evt = new CustomEvent(event, {\n            detail: data\n        });\n        break;\n    }\n\n    target.dispatchEvent(evt);\n}\n\nexport {\n    tuneIn,\n    tuneOut,\n    broadcast\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/util/radio.js\n **/"],"sourceRoot":""}